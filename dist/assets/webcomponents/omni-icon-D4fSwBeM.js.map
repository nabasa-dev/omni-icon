{"version":3,"mappings":"6zCAUA,IAAIA,EAAoC,KAGpCC,EAAoD,KAIlD,EAAe,IAAI,QAMzB,SAAS,GAA0C,CAO/C,MANA,CACI,UAAkB,OAAO,uDAAsB,KAAM,IACjD,EAAW,IAAI,EAAO,iBACf,GACT,CAEC,EAGX,SAAS,EAAe,EAAa,CAC3B,EAAG,UAAY,cAGjB,EAAa,IAAI,EAAG,GAExB,EAAa,IAAI,EAAI,GAAK,CAGrB,GAAW,aAAa,mBAAmB,EAIhD,GAAc,CAAC,KAAM,GAAM,EAAE,eAAe,EAAG,CAAC,GAGpD,SAAS,EAAY,EAAY,CAE7B,GAAI,EAAK,WAAa,KAAK,uBAAwB,CAC/C,EAAK,WAAW,QAAQ,EAAY,CACpC,OAGA,EAAK,WAAa,KAAK,eAGtB,EAAiB,QAAQ,YAAY,CAChC,CAAE,EAAiB,CACnB,MAAM,KAAM,EAAiB,iBAAiB,YAAY,CAAC,EAE7D,QAAS,GAAO,EAAe,EAAG,CAAC,CAM/C,EAAY,SAAS,KAAK,CAOT,IAAI,iBAAkB,GAAc,CACjD,IAAK,GAAM,CAAE,OAAM,gBAAgB,EAC3B,IAAS,aACT,EAAW,QAAQ,EAAY,EAGzC,CAIO,QAAQ,SAAS,KAAM,CAC5B,UAAW,GACX,QAAS,GACZ,CAAC,CAKF,MAAa,MAA6C,EAM7C,EAAoB,GAAsB,CACnD,EAAa,OAAO,EAAG,EClG3B,IAAM,EAAN,cAAuB,WAAY,CAClC,sBAA6B,CAC5B,GAAa,EAAE,eAAe,KAAK,CACnC,EAAiB,KAAK,CAGvB,kBAAyB,CACxB,GAAa,EAAE,iBAAiB,KAAK,GAInC,mBAAoB,QACvB,eAAe,OAAO,YAAa,EAAS","names":["renderer: OmniIconRenderer | null","rendererPromise: Promise<OmniIconRenderer> | null"],"ignoreList":[],"sources":["../../../resources/webcomponents/OmniIconObserver.ts","../../../resources/webcomponents/omni-icon.ts"],"sourcesContent":["import type { OmniIconRenderer } from './OmniIconRenderer';\n\n/**\n * Global OmniIcon Observer\n * \n * This module manages lazy-loading of the OmniIconRenderer and tracks which\n * omni-icon elements have been registered for rendering.\n */\n\n// Singleton renderer instance (lazy-loaded)\nlet renderer: OmniIconRenderer | null = null;\n\n// Promise for lazy-loading the renderer module\nlet rendererPromise: Promise<OmniIconRenderer> | null = null;\n\n// Track which elements have been seen to avoid duplicate processing\n// Using WeakMap instead of WeakSet to support deletion via clearSeenElement\nconst seenElements = new WeakMap<Element, boolean>();\n\n/**\n * Lazy-loads the OmniIconRenderer module\n * Returns cached promise if already loading/loaded\n */\nfunction loadRenderer(): Promise<OmniIconRenderer> {\n    if (!rendererPromise) {\n        rendererPromise = import('./OmniIconRenderer').then((module) => {\n            renderer = new module.OmniIconRenderer();\n            return renderer;\n        });\n    }\n    return rendererPromise;\n}\n\nfunction ensureRenderer(el: Element) {\n    if (!(el.tagName === 'OMNI-ICON')) return;\n\n    // Already processed\n    if (seenElements.has(el)) return;\n\n    seenElements.set(el, true);\n\n    // skip if pre-rendered\n    if ((el as any).hasAttribute('data-prerendered')) {\n        return;\n    }\n\n    loadRenderer().then((r) => r.attachRenderer(el));\n}\n\nfunction processNode(node: Node) {\n    // DocumentFragment (framework inserts)\n    if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        node.childNodes.forEach(processNode);\n        return;\n    }\n\n    if (node.nodeType !== Node.ELEMENT_NODE) return;\n\n    const targets =\n        (node as Element).matches('omni-icon')\n            ? [(node as Element)]\n            : Array.from((node as Element).querySelectorAll('omni-icon'));\n\n    targets.forEach((el) => ensureRenderer(el));\n}\n\n/**\n * Initial scan of existing omni-icon elements in the DOM\n */\nprocessNode(document.body);\n\n/**\n * Global MutationObserver\n * Watches for new omni-icon elements added to the DOM\n * Note: Attribute changes are handled by per-element observers in OmniIconRenderer\n */\nconst observer = new MutationObserver((mutations) => {\n    for (const { type, addedNodes } of mutations) {\n        if (type === 'childList') {\n            addedNodes.forEach(processNode);\n        }\n    }\n});\n\n\n// Start observing the document\nobserver.observe(document.body, {\n    childList: true,\n    subtree: true,\n});\n\n/**\n * Get the current renderer instance (may be null if not yet loaded)\n */\nexport const getRenderer = (): OmniIconRenderer | null => renderer;\n\n/**\n * Mark element as not seen so it can be re-attached if added back to DOM\n * Called when element is disconnected to allow re-initialization on reconnect\n */\nexport const clearSeenElement = (el: Element): void => {\n    seenElements.delete(el);\n};\n","import './omni-icon.scss';\nimport { getRenderer, clearSeenElement } from './OmniIconObserver';\n\nclass OmniIcon extends HTMLElement {\n\tdisconnectedCallback(): void {\n\t\tgetRenderer()?.detachRenderer(this);\n\t\tclearSeenElement(this);\n\t}\n\n\trestartAnimation(): void {\n\t\tgetRenderer()?.restartAnimation(this);\n\t}\n}\n\nif ('customElements' in window) {\n\tcustomElements.define('omni-icon', OmniIcon);\n}\n\nexport default OmniIcon;\n"],"file":"omni-icon-D4fSwBeM.js"}