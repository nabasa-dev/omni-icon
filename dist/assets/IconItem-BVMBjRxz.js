import{t as e}from"./check-qjydXzqM.js";var t=React.forwardRef(({title:e,titleId:t,...n},r)=>ReactJSXRuntime.jsxs(`svg`,{viewBox:`0 0 24 24`,width:`1em`,height:`1em`,ref:r,"aria-labelledby":t,...n,children:[e?ReactJSXRuntime.jsx(`title`,{id:t,children:e}):null,ReactJSXRuntime.jsx(`path`,{fill:`none`,stroke:`currentColor`,strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`m15 6l-6 6l6 6`})]})),n=React.forwardRef(({title:e,titleId:t,...n},r)=>ReactJSXRuntime.jsxs(`svg`,{viewBox:`0 0 24 24`,width:`1em`,height:`1em`,ref:r,"aria-labelledby":t,...n,children:[e?ReactJSXRuntime.jsx(`title`,{id:t,children:e}):null,ReactJSXRuntime.jsx(`path`,{fill:`none`,stroke:`currentColor`,strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`m9 6l6 6l-6 6`})]}));const r=(e,t=300)=>{let[n,r]=wp.element.useState(e);return wp.element.useEffect(()=>{let n=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(n)}},[e,t]),n},i=e=>{let[t,n]=wp.element.useState({}),[r,i]=wp.element.useState(!1),[a,o]=wp.element.useState(!1),[s,c]=wp.element.useState(null),[l,u]=wp.element.useState(0),d=wp.element.useRef(null),f=wp.element.useCallback(()=>{u(e=>e+1)},[]);return wp.element.useEffect(()=>e?((async()=>{d.current&&d.current.abort();let e=new AbortController;d.current=e;try{l===0?i(!0):o(!0),c(null);let t=l>0?`?_=${Date.now()}`:``,r=await fetch(`/wp-json/omni-icon/v1/icon/collections${t}`,{headers:{Accept:`application/json`},signal:e.signal});if(!r.ok)throw Error(`HTTP error! status: ${r.status}`);n((await r.json()).collections||{})}catch(e){if(e.name===`AbortError`)return;c(wp.i18n.__(`Failed to load icon collections`,`omni-icon`)),console.error(`Error fetching collections:`,e)}finally{d.current===e&&(d.current=null,i(!1),o(!1))}})(),()=>{d.current&&=(d.current.abort(),null)}):void 0,[e,l]),{collections:t,isLoading:r,isRefreshing:a,error:s,refreshCollections:f}},a=(e,t)=>{let[n,r]=wp.element.useState([]),[i,a]=wp.element.useState(!1),[o,s]=wp.element.useState(null),c=wp.element.useRef(null);return wp.element.useEffect(()=>{if(!t||!e.trim()){r([]);return}return(async()=>{c.current&&c.current.abort();let t=new AbortController;c.current=t;try{a(!0),s(null);let n=await fetch(`/wp-json/omni-icon/v1/icon/search?query=${encodeURIComponent(e)}`,{headers:{Accept:`application/json`},signal:t.signal});if(!n.ok){let e=(await n.json()).message||`HTTP error! status: ${n.status}`;throw Error(e)}r(((await n.json()).results||[]).map(e=>({name:`${e.prefix}:${e.name}`,prefix:e.prefix,iconName:e.name})))}catch(e){if(e.name===`AbortError`)return;let t=e.message||`Unknown error`;s(wp.i18n.__(`Failed to search icons`,`omni-icon`)+`: `+t),console.error(`Error searching icons:`,e)}finally{c.current===t&&(c.current=null,a(!1))}})(),()=>{c.current&&=(c.current.abort(),null)}},[e,t]),{icons:n,isLoading:i,error:o}},o=(e,t)=>wp.element.useMemo(()=>{let n=[];if(t){let[e,r]=t.split(`:`);e&&r&&n.push({name:t,prefix:e,iconName:r,isCurrent:!0})}return Object.entries(e).forEach(([e,r])=>{r.samples&&Array.isArray(r.samples)&&r.samples.forEach(r=>{let i=`${e}:${r}`;i!==t&&n.push({name:i,prefix:e,iconName:r})})}),n},[e,t]),s=(e,t,n=64)=>{let[r,i]=wp.element.useState(1),a=wp.element.useMemo(()=>t===`all`?e:e.filter(e=>e.prefix===t),[e,t]),o=wp.element.useMemo(()=>Math.ceil(a.length/n),[a.length,n]);return wp.element.useEffect(()=>{i(1)},[t,e]),{filteredIcons:a,paginatedIcons:wp.element.useMemo(()=>{let e=(r-1)*n,t=e+n;return a.slice(e,t)},[a,r,n]),totalPages:o,currentPage:r,setCurrentPage:i,collectionCounts:wp.element.useMemo(()=>{let t={};return e.forEach(e=>{t[e.prefix]=(t[e.prefix]||0)+1}),t},[e])}},c=(e,t,n,r)=>{let[i,a]=wp.element.useState(-1),o=wp.element.useRef(null);wp.element.useEffect(()=>{r&&a(-1)},[e,r]);let s=wp.element.useCallback(()=>{if(!o.current)return 1;let e=o.current.querySelectorAll(`.oiib-icon-item`);if(e.length<2)return 1;let t=e[0].getBoundingClientRect().top,n=1;for(let r=1;r<e.length;r++){let i=e[r].getBoundingClientRect().top;if(Math.abs(i-t)<5)n++;else break}return n},[]),c=wp.element.useCallback(r=>{if(e.length)switch(r.key){case`ArrowRight`:r.preventDefault(),a(t=>{if(t===-1)return 0;let n=t+1;return n>=e.length?t:n});break;case`ArrowLeft`:r.preventDefault(),a(e=>{if(e===-1)return 0;let t=e-1;return t<0?0:t});break;case`ArrowDown`:r.preventDefault(),a(t=>{if(t===-1)return 0;let n=t+s();return n>=e.length?t:n});break;case`ArrowUp`:r.preventDefault(),a(e=>{if(e===-1)return 0;let t=e-s();return t<0?e:t});break;case`Enter`:case` `:r.preventDefault(),i>=0&&i<e.length&&t(e[i].name);break;case`Escape`:r.preventDefault(),n();break;case`Home`:r.preventDefault(),a(0);break;case`End`:r.preventDefault(),a(e.length-1);break;default:break}},[e,i,t,n,s]);return wp.element.useEffect(()=>{if(i>=0&&o.current){let e=o.current.querySelector(`[data-index="${i}"]`);e&&e.scrollIntoView({behavior:`smooth`,block:`nearest`})}},[i]),{selectedIndex:i,setSelectedIndex:a,handleKeyDown:c,gridRef:o}};var l=wp.element.memo(({icon:t,isSelected:n,isFocused:r,onSelect:i,index:a})=>{let[o,s]=wp.element.useState(!1),[c,l]=wp.element.useState(`0px`),[u,d]=wp.element.useState(`3s`),f=wp.element.useCallback(e=>{let t=e.currentTarget.querySelector(`.oiib-icon-name`);if(t&&t.scrollWidth>t.clientWidth){let e=t.scrollWidth-t.clientWidth,n=e/25;l(`-${e}px`),d(`${n}s`),s(!0)}},[]),p=wp.element.useCallback(()=>{s(!1)},[]),m=wp.element.useCallback(()=>{i(t.name)},[t.name,i]),h=wp.element.useCallback(e=>{(e.key===`Enter`||e.key===` `)&&(e.preventDefault(),i(t.name))},[t.name,i]);return ReactJSXRuntime.jsxs(`button`,{className:`oiib-icon-item ${n?`is-selected`:``} ${r?`is-focused`:``}`,onClick:m,onKeyDown:h,onMouseEnter:f,onMouseLeave:p,title:t.name,"data-index":a,tabIndex:r?0:-1,"aria-label":`Select icon ${t.name}`,"aria-pressed":n,children:[n&&ReactJSXRuntime.jsx(`div`,{className:`oiib-icon-selected-badge`,children:ReactJSXRuntime.jsx(e,{})}),ReactJSXRuntime.jsx(`div`,{className:`oiib-icon-preview`,children:ReactJSXRuntime.jsx(`omni-icon`,{name:t.name,width:`32`,height:`32`})}),ReactJSXRuntime.jsxs(`div`,{className:`oiib-icon-label`,children:[ReactJSXRuntime.jsx(`span`,{className:`oiib-icon-name ${o?`is-overflowing`:``}`,style:{"--scroll-distance":c,"--scroll-duration":u},children:t.iconName}),ReactJSXRuntime.jsx(`span`,{className:`oiib-icon-prefix`,children:t.prefix})]})]})});l.displayName=`IconItem`;var u=l;export{s as a,n as c,i,t as l,r as n,a as o,o as r,c as s,u as t};
//# sourceMappingURL=IconItem-BVMBjRxz.js.map