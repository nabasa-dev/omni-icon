import{i as e,n as t,r as n}from"../../check-qjydXzqM.js";import{a as r,c as i,i as a,l as o,n as s,o as c,r as l,s as u,t as d}from"../../IconItem-BVMBjRxz.js";var f=64,p=({isOpen:p,onClose:m,onSelectIcon:h,currentIcon:g})=>{let[_,v]=wp.element.useState(``),y=s(_,300),[b,x]=wp.element.useState(`all`),[S,C]=wp.element.useState(g||null),w=wp.element.useRef(null),{collections:T,isLoading:ee,isRefreshing:E,error:D,refreshCollections:O}=a(p),{icons:k,isLoading:A,error:j}=c(y,p),M=l(T,g),N=wp.element.useMemo(()=>y.trim()?k:M,[y,k,M]),{paginatedIcons:P,totalPages:F,currentPage:I,setCurrentPage:L,collectionCounts:R}=r(N,b,f),z=ee||A,B=D||j,V=wp.element.useCallback(e=>{C(t=>t===e?null:e)},[]),H=wp.element.useCallback(()=>{h(S||``),m()},[S,h,m]),U=wp.element.useCallback(()=>{m()},[m]),{selectedIndex:W,handleKeyDown:G,gridRef:K}=u(P,V,U,p),q=wp.element.useCallback(e=>{if((e.ctrlKey||e.metaKey)&&e.key===`Enter`){e.preventDefault(),H();return}G(e)},[G,H]),J=wp.element.useCallback(()=>{v(``)},[]),Y=wp.element.useCallback(e=>{x(e)},[]),X=wp.element.useCallback(e=>{e<1||e>F||L(e)},[F,L]),Z=wp.element.useCallback(()=>{I>1&&X(I-1)},[I,X]),Q=wp.element.useCallback(()=>{I<F&&X(I+1)},[I,F,X]),$=wp.element.useMemo(()=>b===`all`?N.length:N.filter(e=>e.prefix===b).length,[N,b]);wp.element.useEffect(()=>{if(p)C(g||null),document.body.classList.add(`oiel-modal-open`),setTimeout(()=>{w.current&&w.current.focus()},100);else{let e=setTimeout(()=>{v(``),x(`all`),C(null)},200);return document.body.classList.remove(`oiel-modal-open`),()=>clearTimeout(e)}},[p,g]),wp.element.useEffect(()=>{let e=e=>{e.key===`Escape`&&p&&(e.preventDefault(),e.stopPropagation(),m())};if(p)return document.addEventListener(`keydown`,e,!0),()=>{document.removeEventListener(`keydown`,e,!0)}},[p,m]);let te=wp.element.useMemo(()=>{if(z){if(_){let e=b===`all`?``:` in ${T[b]?.name||b}`;return wp.i18n.__(`Searching for "${_}"${e}...`,`omni-icon`)}return wp.i18n.__(`Loading icons...`,`omni-icon`)}if(y){let e=b===`all`?``:` in ${T[b]?.name||b}`;return $>0?wp.i18n.__(`Found ${$} icons for "${y}"${e}`,`omni-icon`):wp.i18n.__(`No icons found for "${y}"${e}`,`omni-icon`)}return b===`all`?wp.i18n.__(`Showing sample icons from all collections`,`omni-icon`):wp.i18n.__(`Showing sample icons from ${T[b]?.name||b}`,`omni-icon`)},[z,_,y,b,$,T]);return ReactJSXRuntime.jsx(ReactJSXRuntime.Fragment,{children:p&&ReactJSXRuntime.jsx(wp.components.Modal,{title:wp.i18n.__(`Omni Icon â€” Icon Picker`,`omni-icon`),onRequestClose:m,className:`oiib-icon-picker-modal acf-omni-icon-picker-modal`,size:`large`,onKeyDown:q,"aria-label":wp.i18n.__(`Icon Picker`,`omni-icon`),children:ReactJSXRuntime.jsxs(`div`,{className:`oiib-icon-picker-content`,children:[ReactJSXRuntime.jsxs(`div`,{className:`oiib-icon-picker-search`,children:[ReactJSXRuntime.jsxs(`div`,{className:`oiib-search-wrapper`,children:[ReactJSXRuntime.jsx(n,{className:`oiib-search-icon`,"aria-hidden":`true`}),ReactJSXRuntime.jsx(`input`,{ref:w,type:`text`,className:`oiib-search-input`,value:_,onChange:e=>v(e.target.value),placeholder:wp.i18n.__(`Search icons... (e.g., home, mdi:heart, lucide:star)`,`omni-icon`),"aria-label":wp.i18n.__(`Search icons`,`omni-icon`)}),_&&ReactJSXRuntime.jsx(`button`,{className:`oiib-search-clear`,onClick:J,"aria-label":wp.i18n.__(`Clear search`,`omni-icon`),children:ReactJSXRuntime.jsx(e,{})})]}),ReactJSXRuntime.jsx(`button`,{className:`oiib-search-refresh`,onClick:O,disabled:E,"aria-label":wp.i18n.__(`Refresh icon collections`,`omni-icon`),title:wp.i18n.__(`Refresh icon collections`,`omni-icon`),children:ReactJSXRuntime.jsx(t,{className:E?`is-spinning`:``})})]}),Object.keys(T).length>0&&ReactJSXRuntime.jsx(`div`,{className:`oiib-collection-filter`,role:`tablist`,"aria-label":wp.i18n.__(`Filter by collection`,`omni-icon`),children:ReactJSXRuntime.jsxs(`div`,{className:`oiib-collection-filter-wrapper`,children:[ReactJSXRuntime.jsxs(`button`,{className:`oiib-collection-chip ${b===`all`?`is-active`:``}`,onClick:()=>Y(`all`),role:`tab`,"aria-selected":b===`all`,"aria-label":wp.i18n.__(`All collections`,`omni-icon`),children:[wp.i18n.__(`All`,`omni-icon`),ReactJSXRuntime.jsx(`span`,{className:`oiib-collection-count`,"aria-label":`${N.length} icons`,children:N.length})]}),Object.entries(T).map(([e,t])=>{let n=R[e]||0;return y&&n===0?null:ReactJSXRuntime.jsxs(`button`,{className:`oiib-collection-chip ${b===e?`is-active`:``}`,onClick:()=>Y(e),title:t.name,"data-count":n,role:`tab`,"aria-selected":b===e,"aria-label":`${t.name||e}, ${n} icons`,children:[t.name||e,ReactJSXRuntime.jsx(`span`,{className:`oiib-collection-count`,children:n})]},e)})]})}),ReactJSXRuntime.jsxs(`div`,{className:`oiib-icon-picker-info`,children:[ReactJSXRuntime.jsx(`div`,{className:`oiib-info-text`,children:ReactJSXRuntime.jsx(`p`,{children:te})}),!z&&y&&F>1&&ReactJSXRuntime.jsxs(`div`,{className:`oiib-pagination`,role:`navigation`,"aria-label":wp.i18n.__(`Icon pagination`,`omni-icon`),children:[ReactJSXRuntime.jsx(`button`,{className:`oiib-pagination-btn`,onClick:Z,disabled:I===1,"aria-label":wp.i18n.__(`Previous page`,`omni-icon`),children:ReactJSXRuntime.jsx(o,{})}),ReactJSXRuntime.jsx(`span`,{className:`oiib-pagination-info`,"aria-live":`polite`,children:wp.i18n.__(`Page ${I} of ${F}`,`omni-icon`)}),ReactJSXRuntime.jsx(`button`,{className:`oiib-pagination-btn`,onClick:Q,disabled:I===F,"aria-label":wp.i18n.__(`Next page`,`omni-icon`),children:ReactJSXRuntime.jsx(i,{})})]})]}),ReactJSXRuntime.jsxs(`div`,{className:`oiib-icon-picker-content-wrapper`,children:[z&&ReactJSXRuntime.jsxs(`div`,{className:`oiib-icon-picker-loading`,role:`status`,"aria-live":`polite`,children:[ReactJSXRuntime.jsx(wp.components.Spinner,{}),ReactJSXRuntime.jsx(`p`,{children:wp.i18n.__(`Loading icons...`,`omni-icon`)})]}),B&&ReactJSXRuntime.jsx(`div`,{className:`oiib-icon-picker-error`,role:`alert`,children:ReactJSXRuntime.jsx(`p`,{children:B})}),!z&&!B&&P.length>0&&ReactJSXRuntime.jsx(`div`,{className:`oiib-icon-picker-grid`,ref:K,role:`grid`,"aria-label":wp.i18n.__(`Icon grid`,`omni-icon`),children:P.map((e,t)=>ReactJSXRuntime.jsx(d,{icon:e,isSelected:e.name===S,isFocused:t===W,onSelect:V,index:t},e.name))}),!z&&!B&&P.length===0&&y&&ReactJSXRuntime.jsxs(`div`,{className:`oiib-icon-picker-empty`,role:`status`,children:[ReactJSXRuntime.jsx(n,{style:{width:`48px`,height:`48px`},"aria-hidden":`true`}),ReactJSXRuntime.jsx(`h3`,{children:wp.i18n.__(`No icons found`,`omni-icon`)}),ReactJSXRuntime.jsx(`p`,{children:wp.i18n.__(`Try a different search term or icon prefix`,`omni-icon`)})]})]}),S!==g&&(S||g)&&ReactJSXRuntime.jsx(`div`,{className:`oiib-icon-picker-footer`,children:ReactJSXRuntime.jsxs(`div`,{className:`oiib-selected-icon-preview`,children:[S?ReactJSXRuntime.jsxs(`div`,{className:`oiib-selected-icon-display`,children:[ReactJSXRuntime.jsx(`omni-icon`,{name:S,width:`32`,height:`32`}),ReactJSXRuntime.jsxs(`div`,{className:`oiib-selected-icon-info`,children:[ReactJSXRuntime.jsx(`span`,{className:`oiib-selected-icon-label`,children:wp.i18n.__(`Selected:`,`omni-icon`)}),ReactJSXRuntime.jsx(`span`,{className:`oiib-selected-icon-name`,children:S})]})]}):ReactJSXRuntime.jsx(`div`,{className:`oiib-selected-icon-display`,children:ReactJSXRuntime.jsx(`div`,{className:`oiib-selected-icon-info`,children:ReactJSXRuntime.jsx(`span`,{className:`oiib-selected-icon-label`,children:wp.i18n.__(`Icon will be removed`,`omni-icon`)})})}),ReactJSXRuntime.jsxs(`div`,{className:`oiib-confirmation-buttons`,children:[ReactJSXRuntime.jsx(`button`,{className:`oiib-btn oiib-btn-secondary`,onClick:U,"aria-label":wp.i18n.__(`Cancel`,`omni-icon`),children:wp.i18n.__(`Cancel`,`omni-icon`)}),ReactJSXRuntime.jsx(`button`,{className:`oiib-btn oiib-btn-primary`,onClick:H,"aria-label":wp.i18n.__(`Confirm selection`,`omni-icon`),children:wp.i18n.__(`Confirm`,`omni-icon`)})]})]})})]})})})},m=null,h=null,g=null;function _(){let[e,t]=wp.element.useState({isOpen:!1,currentIcon:``,callback:null});wp.element.useEffect(()=>(g=t,()=>{g=null}),[]);let n=()=>{t(e=>({...e,isOpen:!1}))};return ReactJSXRuntime.jsx(p,{isOpen:e.isOpen,onClose:n,onSelectIcon:t=>{e.callback&&e.callback(t),n()},currentIcon:e.currentIcon})}function v(e,t){g?g({isOpen:!0,currentIcon:e||``,callback:t}):console.error(`[Omni Icon] Modal state manager not initialized`)}function y(){g&&g(e=>({...e,isOpen:!1}))}function b(){m||(m=document.createElement(`div`),m.id=`acf-omni-icon-picker-root`,document.body.appendChild(m)),h||=wp.element.createRoot(m),h.render(ReactJSXRuntime.jsx(_,{}))}(async()=>{b();function e(e){return e.closest(`.acf-omni-icon-field`)}function t(e){return e.querySelector(`.acf-omni-icon-input`)}function n(e,n){let i=t(e);if(!i)return;let a=i.value;i.value=n;let o=new CustomEvent(`change`,{bubbles:!0,detail:{oldValue:a,newValue:n}});i.dispatchEvent(o),r(e,n)}function r(e,t){let n=e.querySelector(`.acf-omni-icon-preview`);if(n)if(t){n.innerHTML=`
				<div class="acf-omni-icon-display">
					<omni-icon name="${t}" width="32" height="32"></omni-icon>
					<div class="acf-omni-icon-name">
						<code>${t}</code>
					</div>
				</div>
			`;let r=e.querySelector(`.acf-omni-icon-controls`),i=r?.querySelector(`.acf-omni-icon-remove`);!i&&r&&(i=document.createElement(`button`),i.type=`button`,i.className=`button acf-omni-icon-remove`,i.setAttribute(`data-action`,`remove`),i.textContent=`Remove Icon`,r.appendChild(i))}else{n.innerHTML=`
				<div class="acf-omni-icon-placeholder">
					<p>No icon selected</p>
				</div>
			`;let t=e.querySelector(`.acf-omni-icon-remove`);t&&t.remove()}}window.omniIconPicker={open:(e,t)=>{v(e||``,t||(()=>{}))},close:y},document.addEventListener(`click`,r=>{let i=r.target;if(i.matches(`.acf-omni-icon-browse`)||i.closest(`.acf-omni-icon-browse`)){r.preventDefault(),r.stopPropagation();let a=e(i.closest(`.acf-omni-icon-browse`));if(!a)return;v(t(a)?.value||``,e=>{n(a,e)})}if(i.matches(`.acf-omni-icon-remove`)||i.closest(`.acf-omni-icon-remove`)){r.preventDefault(),r.stopPropagation();let t=e(i.closest(`.acf-omni-icon-remove`));if(!t)return;n(t,``)}}),window.acf&&window.acf.addAction(`append`,function(e){console.log(`[Omni Icon ACF] Field appended, ready for interaction`)})})();